ggplot(aes(x=value, y=key, color = key)) +
geom_point() +
scale_color_viridis_d()
#Did the placebo item get aprox 0 agreement? I.e we don't want 1:s here!
df %>% group_by(placebo_direct) %>% summarise(N=n())
df %>% filter(attentive == 1) %>%
group_by(placebo_direct) %>% summarise(N=n())
df %>% filter(very_attentive == 1) %>%
group_by(placebo_direct) %>% summarise(N=n())
#lets write our function
prmse <- function(estimand, treatment, control) {
sqrt(
(var(treatment, na.rm=TRUE) + var(control, na.rm=TRUE))
+ (estimand - ((mean(treatment, na.rm=TRUE) - mean(control, na.rm=TRUE))^2))
)
}
prmse_a <-  prmse(estimand = .25, df$a_treatment, df$a_control)
#don't know how I failed with the function but I cant pipe into it..
df_att_a <- df %>% filter(very_attentive == 1) #lets filter on the fmc first
prmse_a_att <-  prmse(estimand = .25, df_att_a$a_treatment, df_att_a$a_control)
#lower when dropping inattentives?
prmse_a_att < prmse_a
# lets do that for B
prmse_b <- prmse(estimand = (1/6), df$b_treatment, df$b_control)
prmse_b_placebo <- prmse(estimand = (1/6), df$b_treatment, df$b_placebo)
#and for attentives only
df_att_b <- df %>% filter(very_attentive == 1)
prmse_b_att <- prmse(estimand = (1/6), df_att_b$b_treatment, df_att_b$b_control)
prmse_b_placebo_att <- prmse(estimand = (1/6), df_att_b$b_treatment, df_att_b$b_placebo)
#lower with placebo?
prmse_b_placebo < prmse_b
#lower dropping inattentive?
prmse_b_att < prmse_b
prmse_b_placebo_att < prmse_b_placebo
prmse_b_placebo_att < prmse_b_att
a <- glm(fmc_a ~ audit, data = df %>% filter(attentive==1)) %>%  broom::tidy()
b <- glm(fmc_b ~ audit, data = df%>% filter(attentive==1)) %>%  broom::tidy()
c <- glm(fmc_e ~ audit, data = df%>% filter(attentive==1)) %>%  broom::tidy()
#install.pckages(dotwhisker)
rbind(a,b,c) %>%
filter(term!="(Intercept)") %>%
mutate(model = c("a", "b", "c")) %>%
dotwhisker::dwplot(vline = geom_vline(xintercept = 0, colour = "grey60", linetype = 2),
dot_args = list(aes(color = model), size = 3),
whisker_args = list(aes(color = model)), dodge_size = .7) +
labs(title = "Estimated effect of audit message \non passing fmc")
a <- glm(fmc_a ~ audit_pass, data = df %>% filter(attentive==1)) %>%  broom::tidy()
b <- glm(fmc_b ~ audit_pass, data = df%>% filter(attentive==1)) %>%  broom::tidy()
c <- glm(fmc_e ~ audit_pass, data = df%>% filter(attentive==1)) %>%  broom::tidy()
#install.pckages(dotwhisker)
rbind(a,b,c) %>%
filter(term!="(Intercept)") %>%
mutate(model = c("a", "b", "c")) %>%
dotwhisker::dwplot(vline = geom_vline(xintercept = 0, colour = "grey60", linetype = 2),
dot_args = list(aes(color = model), size = 3),
whisker_args = list(aes(color = model)), dodge_size = .7) +
labs(title = "Estimated effect of audit message \non passing fmc")
a <- glm(fmc_a ~ audit_pass, data = df %>% filter(using=="yes")) %>%  broom::tidy()
b <- glm(fmc_b ~ audit_pass, data = df%>% filter(using=="yes")) %>%  broom::tidy()
c <- glm(fmc_e ~ audit_pass, data = df%>% filter(using=="yes")) %>%  broom::tidy()
#install.pckages(dotwhisker)
rbind(a,b,c) %>%
filter(term!="(Intercept)") %>%
mutate(model = c("a", "b", "c")) %>%
dotwhisker::dwplot(vline = geom_vline(xintercept = 0, colour = "grey60", linetype = 2),
dot_args = list(aes(color = model), size = 3),
whisker_args = list(aes(color = model)), dodge_size = .7) +
labs(title = "Estimated effect of audit message \non passing fmc")
a <- glm(fmc_a ~ audit_pass, data = df) %>%  broom::tidy()
b <- glm(fmc_b ~ audit_pass, data = df) %>%  broom::tidy()
c <- glm(fmc_e ~ audit_pass, data = df) %>%  broom::tidy()
#install.pckages(dotwhisker)
rbind(a,b,c) %>%
filter(term!="(Intercept)") %>%
mutate(model = c("a", "b", "c")) %>%
dotwhisker::dwplot(vline = geom_vline(xintercept = 0, colour = "grey60", linetype = 2),
dot_args = list(aes(color = model), size = 3),
whisker_args = list(aes(color = model)), dodge_size = .7) +
labs(title = "Estimated effect of audit message \non passing fmc")
#how about audit on time?
lm(time_spent ~ audit_pass, data = df %>% filter(time_spent < 1000)) %>%
broom::tidy() %>%
filter(term!="(Intercept)") %>%
dotwhisker::dwplot(vline = geom_vline(xintercept = 0, colour = "grey60", linetype = 2),
dot_args = list(size = 3),
whisker_args = list(), dodge_size = .7) +
labs(title = "Estimated effect of audit message \non time spent")
table(df$audit_pass)
#prmse for audit/non audit
df_audit <- df %>% filter(audit_pass == 1)
df_no_audit <- df %>% filter(audit_pass == 0)
prmse_a_audit <-  prmse(estimand = .25, df_audit$a_treatment, df_audit$a_control)
prmse_a_no_audit <-  prmse(estimand = .25, df_no_audit$a_treatment, df_no_audit$a_control)
prmse_a_audit < prmse_a_no_audit #actually that says very little lets just look at the values for now.
#prmse for audit/non audit
df_audit <- df %>% filter(audit_pass == 1) %>% filter(very_attentive==1)
df_no_audit <- df %>% filter(audit_pass == 0) %>% filter(very_attentive==1)
prmse_a_audit <-  prmse(estimand = .25, df_audit$a_treatment, df_audit$a_control)
prmse_a_no_audit <-  prmse(estimand = .25, df_no_audit$a_treatment, df_no_audit$a_control)
prmse_a_audit < prmse_a_no_audit #actually that says very little lets just look at the values for now.
#prmse for audit/non audit
df_audit <- df %>% filter(audit_pass == 1) %>% filter(attentive==1)
df_no_audit <- df %>% filter(audit_pass == 0) %>% filter(attentive==1)
prmse_a_audit <-  prmse(estimand = .25, df_audit$a_treatment, df_audit$a_control)
prmse_a_no_audit <-  prmse(estimand = .25, df_no_audit$a_treatment, df_no_audit$a_control)
prmse_a_audit < prmse_a_no_audit #actually that says very little lets just look at the values for now.
install.packages("list")
library(list)
data(race)
class(race$treat)
table(race$treat)
dim.results <- ictreg(y ~ 1, data = race,
treat = "treat", J=3, method = "lm")
summary(diff.in.means.results)
summary(dim.results)
dim.results <- ictreg(y ~ 1, data = race,
treat = "treat", J=4, method = "lm")
summary(dim.results)
df <- df %>%
df <- df %>%
mutate(treat_a = ifelse(!is.na(a_treatment), 1, 0),
y_a = ifelse(treat_a==1, a_treatment,
ifelse(treat_a==0, a_control, NA)))
df <- df %>%
mutate(treat_a = ifelse(!is.na(a_treatment), 1, 0),
y_a = ifelse(treat_a==1, a_treatment,
ifelse(treat_a==0, a_control, NA)))
dim.results <- ictreg(y_a ~ 1, data = df,
treat = "treat_a", J=4, method = "lm")
summary(dim.results)
summary(dim.results)
dim.results <- ictreg(y_a ~ 1, data = df,
treat = "treat_a", J=4, method = "nls")
summary(dim.results)
dim.results <- ictreg(y_a ~ 1, data = df,
treat = "treat_a", J=4, method = "ml")
summary(dim.results)
?ictreg
dim.results <- ictreg(y_a ~ 1, data = df,
treat = "treat_a", J=4, method = "lm")
summary(dim.results)
df <- df %>%
mutate(treat_c = ifelse(!is.na(c_treatment), 1, 0),
y_c = ifelse(treat_c==1, c_treatment,
ifelse(treat_c==0, c_control, NA)))
dim.results <- ictreg(y_c ~ 1, data = df,
treat = "treat_c", J=4, method = "lm")
summary(dim.results)
fit.list.c <- ictreg(y_c ~ 1, data = df,
treat = "treat_c", J=4, method = "lm")
fit.sens.c <- glm(c_direct ~ 1,
data = df, family = binomial("logit"))
avg.pred.social.desirability.c <- predict(fit.list.c,
direct.glm = fit.sens.c, se.fit = TRUE)
avg.pred.social.desirability.c
df <- df %>%
mutate(treat_c = ifelse(!is.na(c_treatment), 1, 0),
y_c = ifelse(treat_c==1, c_treatment,
ifelse(treat_c==0, c_control, NA)),
treat_d = ifelse(!is.na(d_treatment), 1, 0),
y_d = ifelse(treat_d==1, d_treatment,
ifelse(treat_d==0, d_control, NA)))
fit.list.c <- ictreg(y_c ~ 1, data = df,
treat = "treat_c", J=4, method = "lm")
fit.sens.c <- glm(c_direct ~ 1,
data = df, family = binomial("logit"))
avg.pred.bias.c <- predict(fit.list.c,
direct.glm = fit.sens.c, se.fit = TRUE)
#D Trust in local government
fit.list.d <- ictreg(y_d ~ 1, data = df,
treat = "treat_c", J=4, method = "lm")
fit.sens.d <- glm(d_direct ~ 1,
data = df, family = binomial("logit"))
avg.pred.bias.d <- predict(fit.list.d,
direct.glm = fit.sens.d, se.fit = TRUE)
avg.pred.bias.d
#D Trust in local government
fit.list.d <- ictreg(y_d ~ 1, data = df,
treat = "treat_d", J=4, method = "lm")
fit.sens.d <- glm(d_direct ~ 1,
data = df, family = binomial("logit"))
avg.pred.bias.d <- predict(fit.list.d,
direct.glm = fit.sens.d, se.fit = TRUE)
avg.pred.bias.d
avg.pred.bias.c
df <- df %>%
mutate(treat_c = ifelse(!is.na(c_treatment), 1, 0),
y_c = ifelse(treat_c==1, c_treatment,
ifelse(treat_c==0, c_control, NA)),
treat_d = ifelse(!is.na(d_treatment), 1, 0),
y_d = ifelse(treat_d==1, d_treatment,
ifelse(treat_d==0, d_control, NA)),
treat_e = ifelse(!is.na(e_treatment), 1, 0),
y_e = ifelse(treat_e==1, e_treatment,
ifelse(treat_d==0, d_control, NA)))
#E Witnessed corruption
fit.list.e <- ictreg(y_e ~ 1, data = df,
treat = "treat_e", J=4, method = "lm")
fit.sens.e <- glm(e_direct ~ 1,
data = df, family = binomial("logit"))
avg.pred.bias.e <- predict(fit.list.e,
direct.glm = fit.sens.e, se.fit = TRUE)
avg.pred.bias.e
#D Trust in local government
fit.list.d <- ictreg(y_d ~ 1, data = df,
treat = "treat_d", J=4, method = "nls")
fit.sens.d <- glm(d_direct ~ 1,
data = df, family = binomial("logit"))
avg.pred.bias.d <- predict(fit.list.d,
direct.glm = fit.sens.d, se.fit = TRUE)
avg.pred.bias.d
#C Trust in national government
fit.list.c <- ictreg(y_c ~ 1, data = df,
treat = "treat_c", J=4, method = "nls")
fit.sens.c <- glm(c_direct ~ 1,
data = df, family = binomial("logit"))
avg.pred.bias.c <- predict(fit.list.c,
direct.glm = fit.sens.c, se.fit = TRUE)
avg.pred.bias.c
#C Trust in national government
fit.list.c <- ictreg(y_c ~ female, data = df,
treat = "treat_c", J=4, method = "nls")
fit.sens.c <- glm(c_direct ~ female,
data = df, family = binomial("logit"))
avg.pred.bias.c <- predict(fit.list.c,
direct.glm = fit.sens.c, se.fit = TRUE)
avg.pred.bias.c
#C Trust in national government
fit.list.c <- ictreg(y_c ~ 1, sponsor, data = df %>% filter(very_attentive==1),
treat = "treat_c", J=4, method = "nls")
#C Trust in national government
fit.list.c <- ictreg(y_c ~ 1, data = df %>% filter(very_attentive==1),
treat = "treat_c", J=4, method = "nls")
fit.sens.c <- glm(c_direct ~ 1,
data = df%>% filter(very_attentive==1), family = binomial("logit"))
avg.pred.bias.c <- predict(fit.list.c,
direct.glm = fit.sens.c, se.fit = TRUE)
avg.pred.bias.c
#D Trust in local government
fit.list.d <- ictreg(y_d ~ 1, data = df%>% filter(very_attentive==1),
treat = "treat_d", J=4, method = "nls")
fit.sens.d <- glm(d_direct ~ 1,
data = df%>% filter(very_attentive==1), family = binomial("logit"))
avg.pred.bias.d <- predict(fit.list.d,
direct.glm = fit.sens.d, se.fit = TRUE)
avg.pred.bias.d
#D Trust in local government
fit.list.d <- ictreg(y_d ~ 1, data = df%>% filter(attentive==1),
treat = "treat_d", J=4, method = "nls")
fit.sens.d <- glm(d_direct ~ 1,
data = df%>% filter(attentive==1), family = binomial("logit"))
avg.pred.bias.d <- predict(fit.list.d,
direct.glm = fit.sens.d, se.fit = TRUE)
avg.pred.bias.d
#C Trust in national government
fit.list.c <- ictreg(y_c ~ 1, data = df %>% filter(attentive==1),
treat = "treat_c", J=4, method = "nls")
fit.sens.c <- glm(c_direct ~ 1,
data = df%>% filter(attentive==1), family = binomial("logit"))
avg.pred.bias.c <- predict(fit.list.c,
direct.glm = fit.sens.c, se.fit = TRUE)
avg.pred.bias.c
df <- df %>% filter(using=="yes")
#D Trust in local government
fit.list.d <- ictreg(y_d ~ 1, data = df%>% filter(attentive==1),
treat = "treat_d", J=4, method = "nls")
fit.sens.d <- glm(d_direct ~ 1,
data = df%>% filter(attentive==1), family = binomial("logit"))
avg.pred.bias.d <- predict(fit.list.d,
direct.glm = fit.sens.d, se.fit = TRUE)
avg.pred.bias.d
#C Trust in national government
fit.list.c <- ictreg(y_c ~ 1, data = df %>% filter(attentive==1),
treat = "treat_c", J=4, method = "nls")
fit.sens.c <- glm(c_direct ~ 1,
data = df%>% filter(attentive==1), family = binomial("logit"))
avg.pred.bias.c <- predict(fit.list.c,
direct.glm = fit.sens.c, se.fit = TRUE)
avg.pred.bias.c
table(df$c_direct_dk)
sum(table(df$c_direct_dk))
avg.pred.bias.c
#C Trust in national government
fit.list.c <- ictreg(y_c ~ 1, data = df %>% filter(attentive==1),
treat = "treat_c", J=4, method = "nls")
fit.sens.c <- glm(c_direct ~ 1,
data = df%>% filter(attentive==1  & c_direct_dk == 0), family = binomial("logit"))
avg.pred.bias.c <- predict(fit.list.c,
direct.glm = fit.sens.c, se.fit = TRUE)
avg.pred.bias.c
#D Trust in local government
fit.list.d <- ictreg(y_d ~ 1, data = df%>% filter(attentive==1),
treat = "treat_d", J=4, method = "nls")
fit.sens.d <- glm(d_direct ~ 1,
data = df%>% filter(attentive==1 & c_direct_dk == 0), family = binomial("logit"))
avg.pred.bias.d <- predict(fit.list.d,
direct.glm = fit.sens.d, se.fit = TRUE)
avg.pred.bias.d
#C Trust in national government
fit.list.c <- ictreg(y_c ~ 1, data = df %>% filter(very_attentive==1),
treat = "treat_c", J=4, method = "nls")
fit.sens.c <- glm(c_direct ~ 1,
data = df%>% filter(very_attentive==1  & c_direct_dk == 0), family = binomial("logit"))
avg.pred.bias.c <- predict(fit.list.c,
direct.glm = fit.sens.c, se.fit = TRUE)
avg.pred.bias.c
#D Trust in local government
fit.list.d <- ictreg(y_d ~ 1, data = df%>% filter(very_attentive==1),
treat = "treat_d", J=4, method = "nls")
fit.sens.d <- glm(d_direct ~ 1,
data = df%>% filter(very_attentive==1 & c_direct_dk == 0), family = binomial("logit"))
avg.pred.bias.d <- predict(fit.list.d,
direct.glm = fit.sens.d, se.fit = TRUE)
avg.pred.bias.d
#E Witnessed corruption
fit.list.e <- ictreg(y_e ~ 1, data = df%>% filter(attentive==1),
treat = "treat_e", J=4, method = "lm")
avg.pred.bias.e <- predict(fit.list.e,
se.fit = TRUE)
avg.pred.bias.e
avg.pred.bias.e <- predict(fit.list.e,
direct.glm = fit.sens.e, se.fit = TRUE)
avg.pred.bias.e
#C Trust in national government
fit.list.c <- ictreg(y_c ~ a, data = df %>% filter(attentive==1) & female ==1 ,
treat = "treat_c", J=4, method = "nls")
fit.sens.c <- glm(c_direct ~ 1,
data = df%>% filter(attentive==1  & c_direct_dk == 0 & female ==1), family = binomial("logit"))
#C Trust in national government
fit.list.c <- ictreg(y_c ~ a, data = df %>% filter(attentive==1 & female ==1),
treat = "treat_c", J=4, method = "nls")
#C Trust in national government
fit.list.c <- ictreg(y_c ~ 1, data = df %>% filter(attentive==1 & female ==1),
treat = "treat_c", J=4, method = "nls")
fit.sens.c <- glm(c_direct ~ 1,
data = df%>% filter(attentive==1  & c_direct_dk == 0 & female ==1), family = binomial("logit"))
avg.pred.bias.c:female <- predict(fit.list.c,
direct.glm = fit.sens.c, se.fit = TRUE)
avg.pred.bias.c.female <- predict(fit.list.c,
direct.glm = fit.sens.c, se.fit = TRUE)
avg.pred.bias.c.female
#C Trust in national government
fit.list.c <- ictreg(y_c ~ 1, data = df %>% filter(attentive==1 & female ==0),
treat = "treat_c", J=4, method = "nls")
fit.sens.c <- glm(c_direct ~ 1,
data = df%>% filter(attentive==1  & c_direct_dk == 0 & female ==0), family = binomial("logit"))
avg.pred.bias.c.male <- predict(fit.list.c,
direct.glm = fit.sens.c, se.fit = TRUE)
avg.pred.bias.c.male
avg.pred.bias.c.female
#E Witnessed corruption
fit.list.e <- ictreg(y_e ~ 1, data = df%>% filter(attentive==1 &female==1),
treat = "treat_e", J=4, method = "lm")
fit.sens.e <- glm(e_direct ~ 1,
data = df%>% filter(attentive==1 &female==1), family = binomial("logit"))
avg.pred.bias.e.f <- predict(fit.list.e,
direct.glm = fit.sens.e, se.fit = TRUE)
#E Witnessed corruption
fit.list.e <- ictreg(y_e ~ 1, data = df%>% filter(attentive==1 &female==0),
treat = "treat_e", J=4, method = "lm")
fit.sens.e <- glm(e_direct ~ 1,
data = df%>% filter(attentive==1 &female==0), family = binomial("logit"))
avg.pred.bias.e.m <- predict(fit.list.e,
direct.glm = fit.sens.e, se.fit = TRUE)
avg.pred.bias.e.f
avg.pred.bias.e.m
#C Trust in national government
fit.list.c <- ictreg(y_c ~ 1, data = df %>% filter(attentive==1 & female ==0),
treat = "treat_c", J=4, method = "lm")
fit.sens.c <- glm(c_direct ~ 1,
data = df%>% filter(attentive==1  & c_direct_dk == 0 & female ==0), family = binomial("logit"))
avg.pred.bias.c.male <- predict(fit.list.c,
direct.glm = fit.sens.c, se.fit = TRUE)
avg.pred.bias.c.male
names(df)
#C Trust in national government
fit.list.c <- ictreg(y_c ~ income + urban_hukou + age + sponsor_gov + work_gov + education, data = df %>% filter(attentive==1 & female ==0),
treat = "treat_c", J=4, method = "lm")
fit.sens.c <- glm(c_direct ~ income + urban_hukou + age + sponsor_gov + work_gov + education,
data = df%>% filter(attentive==1  & c_direct_dk == 0 & female ==0), family = binomial("logit"))
avg.pred.bias.c.female <- predict(fit.list.c,
direct.glm = fit.sens.c, se.fit = TRUE)
avg.pred.bias.c.female
#C Trust in national government
fit.list.c <- ictreg(y_c ~ income + urban_hukou + age + sponsor_gov + work_gov + education, data = df %>% filter(attentive==1 & female ==1),
treat = "treat_c", J=4, method = "lm")
fit.sens.c <- glm(c_direct ~ income + urban_hukou + age + sponsor_gov + work_gov + education,
data = df%>% filter(attentive==1  & c_direct_dk == 0 & female ==1), family = binomial("logit"))
avg.pred.bias.c.female
avg.pred.bias.c.female <- predict(fit.list.c,
direct.glm = fit.sens.c, se.fit = TRUE)
avg.pred.bias.c.female
#C Trust in national government
fit.list.c <- ictreg(y_c ~ income + urban_hukou + age + female + work_gov + education, data = df %>% filter(attentive==1 & sponsor_gov ==1),
treat = "treat_c", J=4, method = "lm")
fit.sens.c <- glm(c_direct ~ income + urban_hukou + age + gemale + work_gov + education,
data = df%>% filter(attentive==1  & c_direct_dk == 0 & sponsor_gov ==1), family = binomial("logit"))
#C Trust in national government
fit.list.c <- ictreg(y_c ~ income + urban_hukou + age + female + work_gov + education, data = df %>% filter(attentive==1 & sponsor_gov ==1),
treat = "treat_c", J=4, method = "lm")
fit.sens.c <- glm(c_direct ~ income + urban_hukou + age + female + work_gov + education,
data = df%>% filter(attentive==1  & c_direct_dk == 0 & sponsor_gov ==1), family = binomial("logit"))
avg.pred.bias.c.sponsor_gov <- predict(fit.list.c,
direct.glm = fit.sens.c, se.fit = TRUE)
avg.pred.bias.c.sponsor_gov
#C Trust in national government
fit.list.c <- ictreg(y_c ~ income + urban_hukou + age + female + work_gov + education, data = df %>% filter(attentive==1 & sponsor_gov ==0),
treat = "treat_c", J=4, method = "lm")
fit.sens.c <- glm(c_direct ~ income + urban_hukou + age + female + work_gov + education,
data = df%>% filter(attentive==1  & c_direct_dk == 0 & sponsor_gov ==0), family = binomial("logit"))
avg.pred.bias.c.sponsor_gov_0 <- predict(fit.list.c,
direct.glm = fit.sens.c, se.fit = TRUE)
avg.pred.bias.c.sponsor_gov_0
#C Trust in national government
fit.list.c <- ictreg(y_c ~ income + urban_hukou + age + female + work_gov + education, data = df %>% filter(attentive==1 & sponsor_gov ==0),
treat = "treat_c", J=4, method = "nls")
fit.sens.c <- glm(c_direct ~ income + urban_hukou + age + female + work_gov + education,
data = df%>% filter(attentive==1  & c_direct_dk == 0 & sponsor_gov ==0), family = binomial("logit"))
avg.pred.bias.c.sponsor_gov_0 <- predict(fit.list.c,
direct.glm = fit.sens.c, se.fit = TRUE)
avg.pred.bias.c.sponsor_gov_0
#C Trust in national government
fit.list.c <- ictreg(y_c ~ income + urban_hukou + age + female + work_gov + education, data = df %>% filter(attentive==1 & sponsor_gov ==1),
treat = "treat_c", J=4, method = "nls")
fit.sens.c <- glm(c_direct ~ income + urban_hukou + age + female + work_gov + education,
data = df%>% filter(attentive==1  & c_direct_dk == 0 & sponsor_gov ==1), family = binomial("logit"))
avg.pred.bias.c.sponsor_gov <- predict(fit.list.c,
direct.glm = fit.sens.c, se.fit = TRUE)
avg.pred.bias.c.sponsor_gov
avg.pred.bias.c.sponsor_gov_0
#C Trust in national government
fit.list.c <- ictreg(y_d ~ income + urban_hukou + age + female + work_gov + education, data = df %>% filter(attentive==1 & sponsor_gov ==1),
treat = "treat_d", J=4, method = "nls")
fit.sens.c <- glm(d_direct ~ income + urban_hukou + age + female + work_gov + education,
data = df%>% filter(attentive==1  & d_direct_dk == 0 & sponsor_gov ==1), family = binomial("logit"))
avg.pred.bias.c.sponsor_gov <- predict(fit.list.c,
direct.glm = fit.sens.c, se.fit = TRUE)
avg.pred.bias.c.sponsor_gov
#C Trust in national government
fit.list.c <- ictreg(y_d ~ income + urban_hukou + age + female + work_gov + education, data = df %>% filter(attentive==1 & sponsor_gov ==0),
treat = "treat_d", J=4, method = "nls")
fit.sens.c <- glm(d_direct ~ income + urban_hukou + age + female + work_gov + education,
data = df%>% filter(attentive==1  & d_direct_dk == 0 & sponsor_gov ==0), family = binomial("logit"))
avg.pred.bias.c.sponsor_gov <- predict(fit.list.c,
direct.glm = fit.sens.c, se.fit = TRUE)
avg.pred.bias.c.sponsor_gov
#E Witnessed corruption
fit.list.e <- ictreg(y_e ~ 1, data = df%>% filter(attentive==1 &sponsor_gov==0),
treat = "treat_e", J=4, method = "lm")
fit.sens.e <- glm(e_direct ~ 1,
data = df%>% filter(attentive==1 &sponsor_gov==0), family = binomial("logit"))
avg.pred.bias.e.g0 <- predict(fit.list.e,
direct.glm = fit.sens.e, se.fit = TRUE)
#E Witnessed corruption
fit.list.e <- ictreg(y_e ~ 1, data = df%>% filter(attentive==1 &sponsor_gov==1),
treat = "treat_e", J=4, method = "lm")
fit.sens.e <- glm(e_direct ~ 1,
data = df%>% filter(attentive==1 &sponsor_gov==1), family = binomial("logit"))
avg.pred.bias.e.g1 <- predict(fit.list.e,
direct.glm = fit.sens.e, se.fit = TRUE)
avg.pred.bias.e.g0
avg.pred.bias.e.g1
#C Trust in national government
fit.list.c <- ictreg(y_c ~ income + urban_hukou + age + female + education, data = df %>% filter(attentive==1 & work_gov ==0),
treat = "treat_c", J=4, method = "nls")
fit.sens.c <- glm(c_direct ~ income + urban_hukou + age + female + education,
data = df%>% filter(attentive==1  & c_direct_dk == 0 & work_gov ==0), family = binomial("logit"))
avg.pred.bias.c.work_gov <- predict(fit.list.c,
direct.glm = fit.sens.c, se.fit = TRUE)
avg.pred.bias.c.work_gov
#C Trust in national government
fit.list.c <- ictreg(y_c ~ income + urban_hukou + age + female + education, data = df %>% filter(attentive==1 & work_gov ==1),
treat = "treat_c", J=4, method = "nls")
fit.sens.c <- glm(c_direct ~ income + urban_hukou + age + female + education,
data = df%>% filter(attentive==1  & c_direct_dk == 0 & work_gov ==1), family = binomial("logit"))
avg.pred.bias.c.work_gov0 <- predict(fit.list.c,
direct.glm = fit.sens.c, se.fit = TRUE)
avg.pred.bias.c.work_gov
avg.pred.bias.c.work_gov0
#C Trust in national government
fit.list.c <- ictreg(y_c ~ income + urban_hukou + age + female + education, data = df %>% filter(attentive==1 & work_gov ==1),
treat = "treat_c", J=4, method = "lm")
fit.sens.c <- glm(c_direct ~ income + urban_hukou + age + female + education,
data = df%>% filter(attentive==1  & c_direct_dk == 0 & work_gov ==1), family = binomial("logit"))
avg.pred.bias.c.work_gov0 <- predict(fit.list.c,
direct.glm = fit.sens.c, se.fit = TRUE)
avg.pred.bias.c.work_gov0
#C Trust in national government
fit.list.c <- ictreg(y_c ~ income + age + female + education, data = df %>% filter(attentive==1 & urban_hukou ==1),
treat = "treat_c", J=4, method = "lm")
fit.sens.c <- glm(c_direct ~ income + urban_hukou + age + female + education,
data = df%>% filter(attentive==1  & c_direct_dk == 0 & urban_hukou ==1), family = binomial("logit"))
#C Trust in national government
fit.list.c <- ictreg(y_c ~ income + age + female + education, data = df %>% filter(attentive==1 & urban_hukou ==1),
treat = "treat_c", J=4, method = "lm")
fit.sens.c <- glm(c_direct ~ income + urban_hukou + age + female + education,
data = df%>% filter(attentive==1  & c_direct_dk == 0 & urban_hukou ==1), family = binomial("logit"))
avg.pred.bias.c.urban <- predict(fit.list.c,
direct.glm = fit.sens.c, se.fit = TRUE)
fit.sens.c <- glm(c_direct ~ income + age + female + education,
data = df%>% filter(attentive==1  & c_direct_dk == 0 & urban_hukou ==1), family = binomial("logit"))
avg.pred.bias.c.urban <- predict(fit.list.c,
direct.glm = fit.sens.c, se.fit = TRUE)
avg.pred.bias.c.urban
#C Trust in national government
fit.list.c <- ictreg(y_c ~ income + age + female + education, data = df %>% filter(attentive==1 & urban_hukou ==0),
treat = "treat_c", J=4, method = "lm")
fit.sens.c <- glm(c_direct ~ income + age + female + education,
data = df%>% filter(attentive==1  & c_direct_dk == 0 & urban_hukou ==0), family = binomial("logit"))
avg.pred.bias.c.rural <- predict(fit.list.c,
direct.glm = fit.sens.c, se.fit = TRUE)
avg.pred.bias.c.rural
